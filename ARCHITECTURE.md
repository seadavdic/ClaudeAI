# Complete Architecture: Raspberry Pi Kubernetes Cluster

## ğŸŒ External Access Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          INTERNET / EXTERNAL                            â”‚
â”‚                                                                         â”‚
â”‚  ğŸ‘¤ User on Mobile/Work/Coffee Shop                                    â”‚
â”‚      â”‚                                                                  â”‚
â”‚      â”‚ HTTPS Request                                                   â”‚
â”‚      â–¼                                                                  â”‚
â”‚  ğŸŒ https://your-tunnel-name.trycloudflare.com                         â”‚
â”‚      â”‚                                                                  â”‚
â”‚      â”‚ Encrypted Tunnel                                                â”‚
â”‚      â–¼                                                                  â”‚
â”‚  â˜ï¸  Cloudflare Network                                                 â”‚
â”‚      â”‚ - TLS Termination                                               â”‚
â”‚      â”‚ - DDoS Protection                                               â”‚
â”‚      â”‚ - Global CDN                                                    â”‚
â”‚      â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Secure Tunnel (No Port Forwarding!)
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ  HOME NETWORK (192.168.1.x)                        â”‚
â”‚                         Your Router                                     â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                     ğŸ’» Windows PC (192.168.1.50)                  â”‚ â”‚
â”‚  â”‚                                                                   â”‚ â”‚
â”‚  â”‚  ğŸ”§ Management Tools:                                             â”‚ â”‚
â”‚  â”‚  â”œâ”€ kubectl â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚ â”‚
â”‚  â”‚  â”œâ”€ Helm â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                  â”‚ â”‚
â”‚  â”‚  â””â”€ Lens (Kubernetes IDE) â”€â”€â”€â”€â”¤                                  â”‚ â”‚
â”‚  â”‚                                â”‚                                  â”‚ â”‚
â”‚  â”‚  ğŸ“ hosts file:                â”‚                                  â”‚ â”‚
â”‚  â”‚  192.168.1.100 grafana.local   â”‚                                  â”‚ â”‚
â”‚  â”‚  192.168.1.100 prometheus.localâ”‚                                  â”‚ â”‚
â”‚  â”‚                                â”‚                                  â”‚ â”‚
â”‚  â”‚  ğŸŒ Browser Access:            â”‚                                  â”‚ â”‚
â”‚  â”‚  http://grafana.local:30683 â—„â”€â”€â”˜                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚         â”‚ Kubernetes API (6443)                                        â”‚
â”‚         â”‚ HTTP Traffic (30683)                                         â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚     ğŸ–¥ï¸  RASPBERRY PI MASTER (192.168.1.100)                     â”‚   â”‚
â”‚  â”‚          Raspbian GNU/Linux 10 (ARMv7)                          â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚              âš™ï¸  k3s Control Plane                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Kubernetes API Server                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Scheduler                                            â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Controller Manager                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - etcd (cluster state)                                 â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚              ğŸ”„ Flux CD GitOps                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  source-controller â”€â”¬â”€â–º ğŸ“¦ GitHub Repo                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  kustomize-controllerâ”‚   yourname/ClaudeAI             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  helm-controller â”€â”€â”€â”€â”˜                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Watches: ./apps/                                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Auto-deploys on Git commits                           â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚          ğŸš¦ Traefik Ingress Controller                  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  NodePort: 30683 (HTTP)                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Routes traffic based on hostname                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  grafana.local â”€â”€â”€â”€â”€â–º grafana-grafana service          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  prometheus.local â”€â”€â–º prometheus-server service        â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚          ğŸ”€ MetalLB Controller                          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  IP Pool: 192.168.1.210-230                            â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  (Not working on WiFi - Layer 2 ARP blocked)           â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  ğŸ“¡ Connection: WiFi (wlan0)                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚         â”‚ Kubernetes Cluster Network                                   â”‚
â”‚         â”‚ (Pod-to-Pod Communication)                                   â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚     ğŸ–¥ï¸  RASPBERRY PI WORKER (192.168.1.101)                     â”‚   â”‚
â”‚  â”‚          Raspbian GNU/Linux 10 (ARMv7)                          â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚              âš™ï¸  k3s Worker Node                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - kubelet (manages pods)                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - containerd (container runtime)                       â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  Running Pods:                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚  â”‚  ğŸ“Š Grafana Pod                                      â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â”œâ”€ Container: grafana:latest                     â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â”œâ”€ Port: 3000                                    â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â”œâ”€ Namespace: grafana                            â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â”œâ”€ Monitoring & Dashboards                       â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â””â”€ Connected to Prometheus datasource            â”‚      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚  â”‚  ğŸ“ˆ Prometheus Pod                                   â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â”œâ”€ Container: prometheus                         â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â”œâ”€ Port: 9090                                    â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â”œâ”€ Namespace: prometheus                         â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â”œâ”€ Scrapes metrics every 30s                     â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â””â”€ Stores time-series data                       â”‚      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚  â”‚  ğŸ Metrics App Pod (Python)                         â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â”œâ”€ Image: python:3.9-slim                        â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â”œâ”€ Port: 8000 (/metrics endpoint)                â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â”œâ”€ Namespace: metrics-app                        â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â”œâ”€ Generates random web server metrics           â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â””â”€ Updates every 60 seconds                      â”‚      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚  â”‚  ğŸŒ Cloudflared Pod (Tunnel)                         â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â”œâ”€ Image: erisamoe/cloudflared:latest            â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â”œâ”€ Creates secure tunnel to Cloudflare           â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â”œâ”€ Proxies: grafana-grafana.svc:80               â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â””â”€ No incoming ports needed!                     â”‚      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚  â”‚  ğŸ”€ MetalLB Speaker Pod                              â”‚      â”‚   â”‚
â”‚  â”‚  â”‚     â””â”€ Announces LoadBalancer IPs (L2)               â”‚      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  ğŸ“¡ Connection: WiFi (wlan0)                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ GitOps Deployment Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        GITOPS WORKFLOW                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  1ï¸âƒ£  Developer (You)                2ï¸âƒ£  GitHub                3ï¸âƒ£  Flux CD
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚              â”‚                  â”‚              â”‚         â”‚              â”‚
  â”‚  Edit files  â”‚                  â”‚  Git Repo    â”‚         â”‚  Watches     â”‚
  â”‚  in apps/    â”‚  â”€â”€git pushâ”€â”€â–º   â”‚  yourname/   â”‚  â—„â”€â”€â”€â”  â”‚  repository  â”‚
  â”‚              â”‚                  â”‚  ClaudeAI    â”‚      â”‚  â”‚              â”‚
  â”‚              â”‚                  â”‚              â”‚      â”‚  â”‚  Detects     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚  changes     â”‚
                                           â”‚              â”‚  â”‚              â”‚
                                           â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚              â”‚         â”‚
                                           â”‚         polls every    â”‚
                                           â”‚           1 minute     â”‚
                                           â”‚              â”‚         â”‚
                                           â–¼              â”‚         â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  apps/       â”‚     â””â”€â”€â”‚  Reconciles  â”‚
                                    â”‚  â”œâ”€grafana/  â”‚        â”‚  cluster     â”‚
                                    â”‚  â”œâ”€prometheusâ”‚        â”‚  state       â”‚
                                    â”‚  â”œâ”€metrics-app        â”‚              â”‚
                                    â”‚  â”œâ”€metallb/  â”‚        â”‚              â”‚
                                    â”‚  â””â”€cloudflared/      â”‚              â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                   â”‚
                                                                   â”‚
                                                                   â–¼
  4ï¸âƒ£  Kubernetes Cluster          â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  Applies changes
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            automatically!
  â”‚  ğŸ“Š Grafana                â”‚
  â”‚  ğŸ“ˆ Prometheus             â”‚
  â”‚  ğŸ Metrics App            â”‚
  â”‚  ğŸ”€ MetalLB                â”‚
  â”‚  ğŸŒ Cloudflared            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Network Traffic Flow

### Local Network Access
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Your Browser â”‚
â”‚ (Windows PC) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. DNS: grafana.local â†’ 192.168.1.100
       â”‚    (from hosts file)
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 192.168.1.100:30683  â”‚
â”‚ (Master Node)         â”‚
â”‚                      â”‚
â”‚  Traefik Ingress     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 2. Route based on hostname
       â”‚    Host: grafana.local
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ grafana-grafana Serviceâ”‚
â”‚ ClusterIP: 10.43.52.82 â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3. Load balance to pod
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Grafana Pod         â”‚
â”‚  Port: 3000          â”‚
â”‚  (Worker Node)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### External Access (Internet)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Internet User      â”‚
â”‚ (Mobile/Work)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1. HTTPS Request
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ https://your-tunnel-name.        â”‚
â”‚ trycloudflare.com                â”‚
â”‚                                  â”‚
â”‚ Cloudflare Edge Network          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 2. Secure tunnel (QUIC protocol)
         â”‚    Encrypted, no port forwarding
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cloudflared Pod (Worker)     â”‚
â”‚ Outbound connection only     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 3. Internal proxy
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ grafana-grafana.grafana.svc  â”‚
â”‚ :80                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Grafana Pod                  â”‚
â”‚ Returns dashboard            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Metrics & Monitoring Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   METRICS COLLECTION PIPELINE                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Step 1: Metrics Generation
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ğŸ Metrics App (Python)             â”‚
  â”‚                                      â”‚
  â”‚  Every 60 seconds:                   â”‚
  â”‚  â”œâ”€ Generate 10-50 random requests   â”‚
  â”‚  â”œâ”€ Simulate response times          â”‚
  â”‚  â”œâ”€ Simulate errors (400, 500)       â”‚
  â”‚  â””â”€ Update active connections        â”‚
  â”‚                                      â”‚
  â”‚  Exposes metrics on:                 â”‚
  â”‚  http://metrics-app:8000/metrics     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ Metrics in Prometheus format
                 â”‚ (Counters, Gauges, Histograms)
                 â”‚
                 â–¼
  Step 2: Metrics Scraping
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ğŸ“ˆ Prometheus Server                â”‚
  â”‚                                      â”‚
  â”‚  Scrape interval: 30 seconds         â”‚
  â”‚  Target: metrics-app.metrics-app     â”‚
  â”‚          .svc.cluster.local:8000     â”‚
  â”‚                                      â”‚
  â”‚  Collected metrics:                  â”‚
  â”‚  â”œâ”€ http_requests_total              â”‚
  â”‚  â”œâ”€ http_request_duration_seconds    â”‚
  â”‚  â”œâ”€ http_active_connections          â”‚
  â”‚  â””â”€ http_errors_total                â”‚
  â”‚                                      â”‚
  â”‚  Stored as time-series data          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ PromQL queries
                 â”‚
                 â–¼
  Step 3: Visualization
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ğŸ“Š Grafana Dashboard                â”‚
  â”‚                                      â”‚
  â”‚  Datasource: Prometheus              â”‚
  â”‚  http://prometheus-prometheus-       â”‚
  â”‚  server.prometheus.svc:80            â”‚
  â”‚                                      â”‚
  â”‚  8 Dashboard Panels:                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚ 1. Total Requests (Counter)    â”‚  â”‚
  â”‚  â”‚ 2. Active Connections (Gauge)  â”‚  â”‚
  â”‚  â”‚ 3. Request Rate (Graph)        â”‚  â”‚
  â”‚  â”‚ 4. Requests by Status (Graph)  â”‚  â”‚
  â”‚  â”‚ 5. Duration p50/p95/p99 (Graph)â”‚  â”‚
  â”‚  â”‚ 6. Error Rate by Type (Graph)  â”‚  â”‚
  â”‚  â”‚ 7. Total Errors (Counter)      â”‚  â”‚
  â”‚  â”‚ 8. Requests by Endpoint (Pie)  â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                      â”‚
  â”‚  Auto-refresh: 30 seconds            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ HTTP
                 â”‚
                 â–¼
  Step 4: User Access
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ğŸ‘¤ User's Browser                   â”‚
  â”‚                                      â”‚
  â”‚  Local: http://grafana.local:30683   â”‚
  â”‚  External: https://[tunnel].         â”‚
  â”‚           trycloudflare.com          â”‚
  â”‚                                      â”‚
  â”‚  View real-time web server metrics   â”‚
  â”‚  with beautiful visualizations!      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› ï¸ Installation Journey (Step by Step)

```
START
  â”‚
  â”œâ”€â–º Step 1: SSH Setup
  â”‚   â”œâ”€ Changed pi user password
  â”‚   â”œâ”€ Generated SSH keys
  â”‚   â”œâ”€ Copied public key to both Pis
  â”‚   â””â”€ âœ… Password-less SSH access
  â”‚
  â”œâ”€â–º Step 2: Network Configuration
  â”‚   â”œâ”€ Set static IPs (100, 101)
  â”‚   â”œâ”€ Identified WiFi interface (wlan0)
  â”‚   â””â”€ âœ… Stable network addresses
  â”‚
  â”œâ”€â–º Step 3: k3s Installation
  â”‚   â”œâ”€ Master: k3s server on 192.168.1.100
  â”‚   â”œâ”€ Worker: k3s agent joins cluster
  â”‚   â”œâ”€ FIX: Auto-detect network interface (wlan0)
  â”‚   â””â”€ âœ… 2-node Kubernetes cluster
  â”‚
  â”œâ”€â–º Step 4: Windows Management Setup
  â”‚   â”œâ”€ Install kubectl
  â”‚   â”œâ”€ Install Helm
  â”‚   â”œâ”€ Install Lens
  â”‚   â”œâ”€ Copy kubeconfig from master
  â”‚   â””â”€ âœ… Remote cluster management
  â”‚
  â”œâ”€â–º Step 5: Flux CD (GitOps)
  â”‚   â”œâ”€ Bootstrap Flux to GitHub
  â”‚   â”œâ”€ Create apps/ directory structure
  â”‚   â”œâ”€ Configure Kustomization to watch apps/
  â”‚   â”œâ”€ ISSUE: Argo CD doesn't support ARM32
  â”‚   â”œâ”€ SOLUTION: Use Flux CD instead
  â”‚   â””â”€ âœ… GitOps automation
  â”‚
  â”œâ”€â–º Step 6: Grafana Deployment
  â”‚   â”œâ”€ Create helmrelease.yaml
  â”‚   â”œâ”€ Commit to Git
  â”‚   â”œâ”€ Flux auto-deploys
  â”‚   â””â”€ âœ… Grafana running
  â”‚
  â”œâ”€â–º Step 7: MetalLB LoadBalancer
  â”‚   â”œâ”€ Create MetalLB manifests
  â”‚   â”œâ”€ Configure IP pool (210-230)
  â”‚   â”œâ”€ Deploy via GitOps
  â”‚   â”œâ”€ ISSUE: Layer 2 doesn't work on WiFi
  â”‚   â””â”€ âš ï¸  NodePort works as alternative
  â”‚
  â”œâ”€â–º Step 8: Traefik Ingress
  â”‚   â”œâ”€ Create ingress.yaml for Grafana
  â”‚   â”œâ”€ Configure hostname: grafana.local
  â”‚   â”œâ”€ Add to Windows hosts file
  â”‚   â””â”€ âœ… Clean URL: http://grafana.local:30683
  â”‚
  â”œâ”€â–º Step 9: Cloudflare Tunnel
  â”‚   â”œâ”€ Create cloudflared deployment
  â”‚   â”œâ”€ ISSUE: Official image no ARM32 support
  â”‚   â”œâ”€ SOLUTION: Use erisamoe/cloudflared
  â”‚   â”œâ”€ ISSUE: Liveness probe failing
  â”‚   â”œâ”€ FIX: Remove liveness probe
  â”‚   â””â”€ âœ… Public access: https://your-tunnel-name.trycloudflare.com
  â”‚
  â”œâ”€â–º Step 10: Prometheus Monitoring
  â”‚   â”œâ”€ Create prometheus HelmRelease
  â”‚   â”œâ”€ Create Ingress for Prometheus UI
  â”‚   â”œâ”€ Configure prometheus.local hostname
  â”‚   â”œâ”€ ISSUE: Wrong service name in Ingress
  â”‚   â”œâ”€ FIX: Use prometheus-prometheus-server
  â”‚   â””â”€ âœ… Prometheus UI: http://prometheus.local:30683
  â”‚
  â”œâ”€â–º Step 11: Metrics Generator App
  â”‚   â”œâ”€ Create Python app with prometheus_client
  â”‚   â”œâ”€ Generate random web server metrics
  â”‚   â”œâ”€ Deploy via ConfigMap (embedded code)
  â”‚   â”œâ”€ Create Service and Namespace
  â”‚   â”œâ”€ Configure Prometheus scrape target
  â”‚   â”œâ”€ Create kustomization.yaml for GitOps
  â”‚   â””â”€ âœ… Metrics app generates data every 60s
  â”‚
  â””â”€â–º Step 12: Grafana Dashboard
      â”œâ”€ Configure Prometheus as datasource
      â”œâ”€ Create Web Server Metrics dashboard
      â”œâ”€ Add 8 visualization panels:
      â”‚   â”œâ”€ Counters (Total Requests, Errors)
      â”‚   â”œâ”€ Gauge (Active Connections)
      â”‚   â”œâ”€ Graphs (Rate, Status, Duration, Errors)
      â”‚   â””â”€ Pie Chart (Requests by Endpoint)
      â”œâ”€ Deploy via ConfigMap
      â””â”€ âœ… Complete monitoring stack operational
END
```

---

## ğŸ“¦ Repository Structure

```
yourname/ClaudeAI/
â”‚
â”œâ”€â”€ ğŸ“ apps/                                    â† Application Deployments
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ grafana/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ helmrepository.yaml             â† Grafana Helm repo
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ helmrelease.yaml                â† Grafana config + Prometheus datasource
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ ingress.yaml                    â† Traefik ingress rules
â”‚   â”‚   â””â”€â”€ ğŸ“„ dashboard-configmap.yaml        â† Web Server Metrics dashboard
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ prometheus/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ helmrepository.yaml             â† Prometheus community Helm repo
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ helmrelease.yaml                â† Prometheus + scrape configs
â”‚   â”‚   â””â”€â”€ ğŸ“„ ingress.yaml                    â† Prometheus UI ingress
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ metrics-app/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ kustomization.yaml              â† Kustomize config for GitOps
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ namespace.yaml                  â† metrics-app namespace
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ deployment.yaml                 â† Python app + ConfigMap
â”‚   â”‚   â””â”€â”€ ğŸ“„ service.yaml                    â† Service exposing /metrics
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ metallb/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ namespace.yaml                  â† metallb-system namespace
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ helmrepository.yaml             â† MetalLB Helm repo
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ helmrelease.yaml                â† MetalLB deployment
â”‚   â”‚   â””â”€â”€ ğŸ“„ ippool.yaml                     â† IP pool + L2 advertisement
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ cloudflared/
â”‚       â””â”€â”€ ğŸ“„ deployment.yaml                 â† Cloudflare Tunnel
â”‚
â”œâ”€â”€ ğŸ“ clusters/my-cluster/                     â† Flux Configuration
â”‚   â”œâ”€â”€ ğŸ“ flux-system/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ gotk-components.yaml            â† Flux controllers
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ gotk-sync.yaml                  â† Git sync config
â”‚   â”‚   â””â”€â”€ ğŸ“„ kustomization.yaml              â† Flux system kustomization
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“„ apps-kustomization.yaml             â† Watches ./apps/ folder
â”‚
â””â”€â”€ ğŸ“ k3s-setup/                               â† Installation Scripts
    â”œâ”€â”€ ğŸ“ scripts/
    â”‚   â”œâ”€â”€ ğŸ“„ 00-prerequisites.sh             â† System prep
    â”‚   â”œâ”€â”€ ğŸ“„ 01-install-master.sh            â† k3s master installation
    â”‚   â”œâ”€â”€ ğŸ“„ 02-install-worker.sh            â† k3s worker installation
    â”‚   â””â”€â”€ ğŸ“„ 03-verify-cluster.sh            â† Cluster verification
    â”‚
    â”œâ”€â”€ ğŸ“„ README.md                            â† Setup overview
    â””â”€â”€ ğŸ“„ INSTALLATION-GUIDE.md                â† Detailed guide
```

---

## ğŸ”§ Technology Stack Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      APPLICATION LAYER                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚  Grafana   â”‚  â”‚ Prometheus â”‚  â”‚  Metrics   â”‚                â”‚
â”‚  â”‚ Dashboards â”‚  â”‚  Metrics   â”‚  â”‚    App     â”‚                â”‚
â”‚  â”‚            â”‚  â”‚  Storage   â”‚  â”‚  (Python)  â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚       â”‚                 â–²                â”‚                      â”‚
â”‚       â””â”€â”€â”€â”€â”€queriesâ”€â”€â”€â”€â”€â”˜                â”‚                      â”‚
â”‚                                          â”‚                      â”‚
â”‚                    â—„â”€â”€â”€â”€â”€â”€scrapesâ”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NETWORKING LAYER                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   Traefik    â”‚  â”‚   MetalLB    â”‚  â”‚  Cloudflare  â”‚          â”‚
â”‚  â”‚   Ingress    â”‚  â”‚ LoadBalancer â”‚  â”‚    Tunnel    â”‚          â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚          â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ IP Pool:     â”‚  â”‚ Public HTTPS â”‚          â”‚
â”‚  â”‚ â”‚hostname  â”‚ â”‚  â”‚ 210-230      â”‚  â”‚ Access       â”‚          â”‚
â”‚  â”‚ â”‚routing   â”‚ â”‚  â”‚              â”‚  â”‚              â”‚          â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ORCHESTRATION LAYER                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚         Kubernetes (k3s v1.34.3)                 â”‚           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚           â”‚
â”‚  â”‚  â”‚ API Server â”‚  â”‚ Scheduler  â”‚  â”‚ Controller â”‚ â”‚           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚         Flux CD (GitOps)                         â”‚           â”‚
â”‚  â”‚  source â†’ kustomize â†’ helm controllers           â”‚           â”‚
â”‚  â”‚  Auto-sync with GitHub every 1 minute            â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CONTAINER LAYER                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚         containerd v2.1.5-k3s1                   â”‚           â”‚
â”‚  â”‚  - Container runtime                             â”‚           â”‚
â”‚  â”‚  - Image pulling                                 â”‚           â”‚
â”‚  â”‚  - Pod lifecycle management                      â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    OPERATING SYSTEM                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚      Raspbian GNU/Linux 10 (Buster)              â”‚           â”‚
â”‚  â”‚      Kernel: 5.10.103-v7l+                       â”‚           â”‚
â”‚  â”‚      Architecture: ARMv7 (32-bit)                â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      HARDWARE LAYER                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  Raspberry Pi #1   â”‚        â”‚  Raspberry Pi #2   â”‚           â”‚
â”‚  â”‚  (Master Node)     â”‚â—„â”€â”€â”€â”€â”€â”€â–ºâ”‚  (Worker Node)     â”‚           â”‚
â”‚  â”‚  192.168.1.100     â”‚  WiFi  â”‚  192.168.1.101     â”‚           â”‚
â”‚  â”‚  wlan0             â”‚        â”‚  wlan0             â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Access Points Summary

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 HOW TO ACCESS YOUR SERVICES                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ğŸ“Š GRAFANA (Dashboards & Visualizations)
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Local:  http://grafana.local:30683                      â”‚
  â”‚  External: https://[tunnel].trycloudflare.com            â”‚
  â”‚                                                          â”‚
  â”‚  ğŸ” Login:                                               â”‚
  â”‚    Username: admin                                       â”‚
  â”‚    Password: <your-grafana-password>                     â”‚
  â”‚                                                          â”‚
  â”‚  Features:                                               â”‚
  â”‚  â”œâ”€ Web Server Metrics dashboard                         â”‚
  â”‚  â”œâ”€ Real-time data (30s refresh)                         â”‚
  â”‚  â””â”€ 8 visualization panels                               â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ğŸ“ˆ PROMETHEUS (Metrics & Time-Series DB)
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Local:  http://prometheus.local:30683                   â”‚
  â”‚                                                          â”‚
  â”‚  Features:                                               â”‚
  â”‚  â”œâ”€ Query metrics with PromQL                            â”‚
  â”‚  â”œâ”€ View targets (Status â†’ Targets)                     â”‚
  â”‚  â”œâ”€ Explore collected metrics                            â”‚
  â”‚  â””â”€ See scrape configurations                            â”‚
  â”‚                                                          â”‚
  â”‚  No authentication required (internal use)               â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ğŸ METRICS APP (Metrics Generator)
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Endpoint: http://metrics-app.metrics-app.svc:8000       â”‚
  â”‚  Metrics:  http://metrics-app.metrics-app.svc:8000/      â”‚
  â”‚            metrics                                       â”‚
  â”‚                                                          â”‚
  â”‚  Internal service - scraped by Prometheus every 30s      â”‚
  â”‚  Generates random web server metrics every 60s           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ğŸ’¡ REQUIREMENTS FOR LOCAL ACCESS:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Add to Windows hosts file:                              â”‚
  â”‚  C:\Windows\System32\drivers\etc\hosts                   â”‚
  â”‚                                                          â”‚
  â”‚  192.168.1.100 grafana.local                             â”‚
  â”‚  192.168.1.100 prometheus.local                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ Deployment Process Visualization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            FROM CODE COMMIT TO RUNNING APPLICATION              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â±ï¸  Time: ~1-2 minutes (automatic!)

  Step 1: Developer Action
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ $ git add apps/    â”‚
  â”‚ $ git commit -m "" â”‚
  â”‚ $ git push         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Pushes to GitHub
            â–¼
  Step 2: GitHub Repository
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Repository updated         â”‚
  â”‚ Commit SHA: abc123...      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Flux polls every 1min
            â–¼
  Step 3: Flux Detection
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ source-controller detects  â”‚
  â”‚ new commit                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Pulls changes
            â–¼
  Step 4: Flux Processing
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ kustomize-controller       â”‚
  â”‚ processes ./apps/          â”‚
  â”‚                            â”‚
  â”‚ helm-controller            â”‚
  â”‚ processes HelmReleases     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Applies to cluster
            â–¼
  Step 5: Kubernetes Apply
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ kubectl apply -f ...       â”‚
  â”‚ (automatically!)           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Creates/Updates resources
            â–¼
  Step 6: Resource Creation
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Deployments                â”‚
  â”‚ Services                   â”‚
  â”‚ Ingresses                  â”‚
  â”‚ ConfigMaps                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Scheduler assigns pods
            â–¼
  Step 7: Pod Scheduling
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Scheduler picks node       â”‚
  â”‚ (master or worker)         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ kubelet starts pod
            â–¼
  Step 8: Container Runtime
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ containerd pulls image     â”‚
  â”‚ Creates container          â”‚
  â”‚ Starts process             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Application ready
            â–¼
  Step 9: Service Ready
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ âœ… Pod running              â”‚
  â”‚ âœ… Service routing traffic  â”‚
  â”‚ âœ… Ingress configured       â”‚
  â”‚ âœ… Publicly accessible      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Troubleshooting Reference

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PROBLEMS SOLVED                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  âŒ Problem: Worker node can't join cluster
  â”œâ”€ Cause: Hardcoded eth0 interface, but using WiFi (wlan0)
  â””â”€ âœ… Solution: Auto-detect network interface in scripts

  âŒ Problem: kubectl can't connect
  â”œâ”€ Cause: Wrong server IP in kubeconfig (127.0.0.1)
  â””â”€ âœ… Solution: Change to master IP (192.168.1.100)

  âŒ Problem: Argo CD ImagePullBackOff
  â”œâ”€ Cause: Argo CD doesn't support ARM32 (ARMv7)
  â””â”€ âœ… Solution: Use Flux CD instead (ARM32 compatible)

  âŒ Problem: Flux not deploying apps
  â”œâ”€ Cause: Only watching ./clusters/my-cluster path
  â””â”€ âœ… Solution: Create Kustomization to watch ./apps

  âŒ Problem: Grafana chart version not found
  â”œâ”€ Cause: Specified version 11.3.0 doesn't exist
  â””â”€ âœ… Solution: Remove version, use latest

  âŒ Problem: SSH requires password every time
  â”œâ”€ Cause: No SSH key authentication
  â””â”€ âœ… Solution: ssh-keygen + ssh-copy-id

  âŒ Problem: MetalLB LoadBalancer IP not reachable
  â”œâ”€ Cause: WiFi blocks Layer 2 ARP announcements
  â””â”€ âœ… Solution: Use NodePort or Cloudflare Tunnel

  âŒ Problem: Cloudflared ImagePullBackOff
  â”œâ”€ Cause: Official image doesn't support ARM32
  â””â”€ âœ… Solution: Use erisamoe/cloudflared community image

  âŒ Problem: Cloudflared CrashLoopBackOff
  â”œâ”€ Cause: Liveness probe fails (no /ready endpoint)
  â””â”€ âœ… Solution: Remove liveness probe from deployment
```

---

## ğŸ“ˆ Current Stack & Future Expansion

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WHAT YOU HAVE NOW                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  âœ… IMPLEMENTED:
  â”œâ”€ k3s Kubernetes cluster (2 nodes)
  â”œâ”€ Flux CD GitOps automation
  â”œâ”€ Traefik Ingress Controller
  â”œâ”€ Cloudflare Tunnel (public access)
  â”œâ”€ Grafana (dashboards & visualization)
  â”œâ”€ Prometheus (metrics collection & storage)
  â”œâ”€ Custom Metrics App (Python)
  â””â”€ Complete monitoring pipeline

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  WHAT YOU CAN ADD NEXT                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ğŸ“Š Enhanced Monitoring
  â”œâ”€ Loki (log aggregation)
  â”œâ”€ AlertManager (notifications via email/Slack)
  â”œâ”€ More custom metrics apps

  ğŸ—„ï¸ Databases
  â”œâ”€ PostgreSQL
  â”œâ”€ MySQL
  â”œâ”€ MongoDB
  â””â”€ Redis

  ğŸŒ Applications
  â”œâ”€ WordPress blog
  â”œâ”€ NextCloud (file storage)
  â”œâ”€ Home Assistant (home automation)
  â”œâ”€ Plex/Jellyfin (media server)
  â””â”€ Your custom apps!

  ğŸ”’ Security
  â”œâ”€ cert-manager (automatic SSL certificates)
  â”œâ”€ OAuth2 Proxy (authentication)
  â”œâ”€ Vault (secrets management)
  â””â”€ Network Policies (pod firewall)

  ğŸ“¦ Storage
  â”œâ”€ Longhorn (distributed storage)
  â”œâ”€ NFS provisioner
  â””â”€ Local path provisioner

  All deployed via GitOps - just commit to Git! ğŸš€
```

---

**Created:** 2026-01-04
**Last Updated:** 2026-01-06
**Cluster:** 2x Raspberry Pi (ARMv7)
**GitOps:** Flux CD
**Monitoring:** Prometheus + Grafana + Custom Metrics App
**Public Access:** Cloudflare Tunnel

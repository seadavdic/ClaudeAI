apiVersion: v1
kind: ConfigMap
metadata:
  name: smartbiz-ui-files
  namespace: smartbiz
data:
  index.html: |
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>SmartBiz - Business Management</title>
        <link rel="stylesheet" href="/style.css">
    </head>
    <body>
        <div class="container">
            <header>
                <h1>SmartBiz Management System</h1>
                <p>Powered by AI</p>
            </header>

            <nav class="tabs">
                <button class="tab-button active" onclick="showTab('articles')">Articles</button>
                <button class="tab-button" onclick="showTab('customers')">Customers</button>
                <button class="tab-button" onclick="showTab('orders')">Orders</button>
                <button class="tab-button" onclick="showTab('dashboard')">Dashboard</button>
            </nav>

            <!-- Articles Tab -->
            <div id="articles" class="tab-content active">
                <h2>Articles Management</h2>
                <div class="form-section">
                    <h3>Add New Article</h3>
                    <form id="articleForm">
                        <div class="form-group">
                            <label for="articleName">Article Name:</label>
                            <input type="text" id="articleName" required>
                            <button type="button" class="ai-button" onclick="suggestCategory()">AI Suggest Category</button>
                        </div>
                        <div class="form-group">
                            <label for="articleCategory">Category:</label>
                            <input type="text" id="articleCategory" required>
                            <span id="categoryConfidence" class="ai-hint"></span>
                        </div>
                        <div class="form-group">
                            <label for="articleDescription">Description:</label>
                            <textarea id="articleDescription" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="articlePrice">Price:</label>
                            <input type="number" id="articlePrice" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="articleStock">Stock:</label>
                            <input type="number" id="articleStock" required>
                        </div>
                        <button type="submit" class="submit-button">Add Article</button>
                    </form>
                </div>
                <div class="list-section">
                    <h3>Articles List</h3>
                    <div id="articlesList" class="items-list"></div>
                </div>
            </div>

            <!-- Customers Tab -->
            <div id="customers" class="tab-content">
                <h2>Customers Management</h2>
                <div class="form-section">
                    <h3>Add New Customer</h3>
                    <form id="customerForm">
                        <div class="form-group">
                            <label for="customerName">Name:</label>
                            <input type="text" id="customerName" required>
                        </div>
                        <div class="form-group">
                            <label for="customerEmail">Email:</label>
                            <input type="email" id="customerEmail" required>
                            <button type="button" class="ai-button" onclick="validateEmail()">AI Validate</button>
                            <span id="emailValidation" class="ai-hint"></span>
                        </div>
                        <div class="form-group">
                            <label for="customerPhone">Phone:</label>
                            <input type="tel" id="customerPhone" required>
                        </div>
                        <div class="form-group">
                            <label for="customerAddress">Address:</label>
                            <textarea id="customerAddress" required></textarea>
                        </div>
                        <button type="submit" class="submit-button">Add Customer</button>
                    </form>
                </div>
                <div class="list-section">
                    <h3>Customers List</h3>
                    <div id="customersList" class="items-list"></div>
                </div>
            </div>

            <!-- Orders Tab -->
            <div id="orders" class="tab-content">
                <h2>Orders Management</h2>
                <div class="form-section">
                    <h3>Create New Order</h3>
                    <form id="orderForm">
                        <div class="form-group">
                            <label for="orderCustomer">Customer:</label>
                            <select id="orderCustomer" required>
                                <option value="">Select Customer</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="orderArticle">Article:</label>
                            <select id="orderArticle" required>
                                <option value="">Select Article</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="orderQuantity">Quantity:</label>
                            <input type="number" id="orderQuantity" min="1" required>
                        </div>
                        <button type="submit" class="submit-button">Create Order</button>
                    </form>
                </div>
                <div class="list-section">
                    <h3>Orders List</h3>
                    <div id="ordersList" class="items-list"></div>
                </div>
            </div>

            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content">
                <h2>Dashboard</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Total Articles</h3>
                        <p id="statArticles" class="stat-value">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Total Customers</h3>
                        <p id="statCustomers" class="stat-value">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Total Orders</h3>
                        <p id="statOrders" class="stat-value">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Total Revenue</h3>
                        <p id="statRevenue" class="stat-value">$0.00</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="notification" class="notification"></div>
        <script src="/app.js"></script>
    </body>
    </html>

  style.css: |
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 10px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        overflow: hidden;
    }

    header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        text-align: center;
    }

    header h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
    }

    header p {
        font-size: 1.2em;
        opacity: 0.9;
    }

    .tabs {
        display: flex;
        background: #f5f5f5;
        border-bottom: 2px solid #ddd;
    }

    .tab-button {
        flex: 1;
        padding: 15px;
        border: none;
        background: transparent;
        cursor: pointer;
        font-size: 16px;
        font-weight: 500;
        transition: all 0.3s;
    }

    .tab-button:hover {
        background: #e0e0e0;
    }

    .tab-button.active {
        background: white;
        border-bottom: 3px solid #667eea;
    }

    .tab-content {
        display: none;
        padding: 30px;
    }

    .tab-content.active {
        display: block;
    }

    h2 {
        color: #333;
        margin-bottom: 20px;
    }

    h3 {
        color: #555;
        margin-bottom: 15px;
    }

    .form-section {
        background: #f9f9f9;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 30px;
    }

    .form-group {
        margin-bottom: 15px;
    }

    label {
        display: block;
        margin-bottom: 5px;
        color: #555;
        font-weight: 500;
    }

    input, textarea, select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        font-size: 14px;
    }

    textarea {
        min-height: 80px;
        resize: vertical;
    }

    .ai-button {
        margin-top: 5px;
        padding: 8px 15px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 13px;
    }

    .ai-button:hover {
        opacity: 0.9;
    }

    .ai-hint {
        display: block;
        margin-top: 5px;
        font-size: 12px;
        color: #667eea;
    }

    .submit-button {
        padding: 12px 30px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 500;
    }

    .submit-button:hover {
        opacity: 0.9;
    }

    .items-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 15px;
    }

    .item-card {
        background: #f9f9f9;
        padding: 15px;
        border-radius: 8px;
        border-left: 4px solid #667eea;
    }

    .item-card h4 {
        color: #333;
        margin-bottom: 10px;
    }

    .item-card p {
        color: #666;
        font-size: 14px;
        margin: 5px 0;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .stat-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        border-radius: 10px;
        text-align: center;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    .stat-card h3 {
        color: white;
        font-size: 18px;
        margin-bottom: 15px;
    }

    .stat-value {
        font-size: 36px;
        font-weight: bold;
    }

    .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 25px;
        background: #4caf50;
        color: white;
        border-radius: 5px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        display: none;
        z-index: 1000;
    }

    .notification.error {
        background: #f44336;
    }

    .notification.show {
        display: block;
        animation: slideIn 0.3s ease-in-out;
    }

    @keyframes slideIn {
        from {
            transform: translateX(400px);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }

  app.js: |
    const API_URL = '/api';

    // Tab Management
    function showTab(tabName) {
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active');
        });
        document.querySelectorAll('.tab-button').forEach(btn => {
            btn.classList.remove('active');
        });
        document.getElementById(tabName).classList.add('active');
        event.target.classList.add('active');

        if (tabName === 'orders') {
            loadCustomersForOrders();
            loadArticlesForOrders();
        }
        if (tabName === 'dashboard') {
            loadDashboard();
        }
    }

    // Notification System
    function showNotification(message, isError = false) {
        const notification = document.getElementById('notification');
        notification.textContent = message;
        notification.className = 'notification show' + (isError ? ' error' : '');
        setTimeout(() => {
            notification.classList.remove('show');
        }, 3000);
    }

    // AI Features
    async function suggestCategory() {
        const articleName = document.getElementById('articleName').value;
        if (!articleName) {
            showNotification('Please enter an article name first', true);
            return;
        }

        try {
            const response = await fetch(`${API_URL}/ai/suggest-category?article_name=${encodeURIComponent(articleName)}`, {
                method: 'POST'
            });
            const data = await response.json();
            document.getElementById('articleCategory').value = data.suggested_category;
            document.getElementById('categoryConfidence').textContent =
                `AI Confidence: ${(data.confidence * 100).toFixed(0)}%`;
            showNotification('Category suggested by AI!');
        } catch (error) {
            showNotification('AI suggestion failed: ' + error.message, true);
        }
    }

    async function validateEmail() {
        const email = document.getElementById('customerEmail').value;
        if (!email) {
            showNotification('Please enter an email first', true);
            return;
        }

        try {
            const response = await fetch(`${API_URL}/ai/validate-email?email=${encodeURIComponent(email)}`, {
                method: 'POST'
            });
            const data = await response.json();
            const validationSpan = document.getElementById('emailValidation');
            if (data.is_valid) {
                validationSpan.textContent = '✓ Valid email';
                validationSpan.style.color = '#4caf50';
            } else {
                validationSpan.textContent = '✗ Invalid email';
                validationSpan.style.color = '#f44336';
            }
        } catch (error) {
            showNotification('Email validation failed: ' + error.message, true);
        }
    }

    // Article Management
    document.getElementById('articleForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const article = {
            name: document.getElementById('articleName').value,
            category: document.getElementById('articleCategory').value,
            description: document.getElementById('articleDescription').value,
            price: parseFloat(document.getElementById('articlePrice').value),
            stock: parseInt(document.getElementById('articleStock').value)
        };

        try {
            const response = await fetch(`${API_URL}/articles`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(article)
            });

            if (response.ok) {
                showNotification('Article added successfully!');
                e.target.reset();
                document.getElementById('categoryConfidence').textContent = '';
                loadArticles();
            } else {
                throw new Error('Failed to add article');
            }
        } catch (error) {
            showNotification('Error: ' + error.message, true);
        }
    });

    async function loadArticles() {
        try {
            const response = await fetch(`${API_URL}/articles`);
            const articles = await response.json();

            const listDiv = document.getElementById('articlesList');
            listDiv.innerHTML = articles.map(article => `
                <div class="item-card">
                    <h4>${article.name}</h4>
                    <p><strong>Category:</strong> ${article.category}</p>
                    <p><strong>Price:</strong> $${article.price.toFixed(2)}</p>
                    <p><strong>Stock:</strong> ${article.stock}</p>
                    <p>${article.description}</p>
                </div>
            `).join('');
        } catch (error) {
            showNotification('Error loading articles: ' + error.message, true);
        }
    }

    // Customer Management
    document.getElementById('customerForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const customer = {
            name: document.getElementById('customerName').value,
            email: document.getElementById('customerEmail').value,
            phone: document.getElementById('customerPhone').value,
            address: document.getElementById('customerAddress').value
        };

        try {
            const response = await fetch(`${API_URL}/customers`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(customer)
            });

            if (response.ok) {
                showNotification('Customer added successfully!');
                e.target.reset();
                document.getElementById('emailValidation').textContent = '';
                loadCustomers();
            } else {
                throw new Error('Failed to add customer');
            }
        } catch (error) {
            showNotification('Error: ' + error.message, true);
        }
    });

    async function loadCustomers() {
        try {
            const response = await fetch(`${API_URL}/customers`);
            const customers = await response.json();

            const listDiv = document.getElementById('customersList');
            listDiv.innerHTML = customers.map(customer => `
                <div class="item-card">
                    <h4>${customer.name}</h4>
                    <p><strong>Email:</strong> ${customer.email}</p>
                    <p><strong>Phone:</strong> ${customer.phone}</p>
                    <p><strong>Address:</strong> ${customer.address}</p>
                </div>
            `).join('');
        } catch (error) {
            showNotification('Error loading customers: ' + error.message, true);
        }
    }

    // Order Management
    async function loadCustomersForOrders() {
        try {
            const response = await fetch(`${API_URL}/customers`);
            const customers = await response.json();

            const select = document.getElementById('orderCustomer');
            select.innerHTML = '<option value="">Select Customer</option>' +
                customers.map(c => `<option value="${c.id}">${c.name} (${c.email})</option>`).join('');
        } catch (error) {
            console.error('Error loading customers:', error);
        }
    }

    async function loadArticlesForOrders() {
        try {
            const response = await fetch(`${API_URL}/articles`);
            const articles = await response.json();

            const select = document.getElementById('orderArticle');
            select.innerHTML = '<option value="">Select Article</option>' +
                articles.map(a => `<option value="${a.id}">${a.name} - $${a.price.toFixed(2)} (Stock: ${a.stock})</option>`).join('');
        } catch (error) {
            console.error('Error loading articles:', error);
        }
    }

    document.getElementById('orderForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const order = {
            customer_id: parseInt(document.getElementById('orderCustomer').value),
            article_id: parseInt(document.getElementById('orderArticle').value),
            quantity: parseInt(document.getElementById('orderQuantity').value)
        };

        try {
            const response = await fetch(`${API_URL}/orders`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(order)
            });

            if (response.ok) {
                showNotification('Order created successfully!');
                e.target.reset();
                loadOrders();
            } else {
                const error = await response.json();
                throw new Error(error.detail || 'Failed to create order');
            }
        } catch (error) {
            showNotification('Error: ' + error.message, true);
        }
    });

    async function loadOrders() {
        try {
            const response = await fetch(`${API_URL}/orders`);
            const orders = await response.json();

            const listDiv = document.getElementById('ordersList');
            listDiv.innerHTML = orders.map(order => `
                <div class="item-card">
                    <h4>Order #${order.id}</h4>
                    <p><strong>Customer ID:</strong> ${order.customer_id}</p>
                    <p><strong>Article ID:</strong> ${order.article_id}</p>
                    <p><strong>Quantity:</strong> ${order.quantity}</p>
                    <p><strong>Total:</strong> $${order.total_price.toFixed(2)}</p>
                    <p><strong>Status:</strong> ${order.status}</p>
                </div>
            `).join('');
        } catch (error) {
            showNotification('Error loading orders: ' + error.message, true);
        }
    }

    // Dashboard
    async function loadDashboard() {
        try {
            const response = await fetch(`${API_URL}/stats`);
            const stats = await response.json();

            document.getElementById('statArticles').textContent = stats.total_articles;
            document.getElementById('statCustomers').textContent = stats.total_customers;
            document.getElementById('statOrders').textContent = stats.total_orders;
            document.getElementById('statRevenue').textContent = '$' + stats.total_revenue.toFixed(2);
        } catch (error) {
            showNotification('Error loading dashboard: ' + error.message, true);
        }
    }

    // Initial Load
    loadArticles();
    loadCustomers();
    loadOrders();
